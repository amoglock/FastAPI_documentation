<h3>Параметры заголовка</h3>

Вы можете объявить параметры Header таким же способом, как вы объявляете параметры `Query`, `Path` и `Cookie`.

<h3>Импорт `Header`</h3>

Сперва импортируйте `Header`:

```python
from typing import  Annotated

from fastapi import FastAPI, Header

app = FastAPI()
...
```

<h3>Объявление параметров `Header`</h3>

Затем объявите параметры заголовка, используя такую же структуру как в `Path`, `Query` и `Cookie`.

Первое значение стандартное, вы можете передавать все дополнительные проверки или аннотацию параметров:

```python
from typing import  Annotated

from fastapi import FastAPI, Header

app = FastAPI()

@app.get("/items/")
async def read_items(user_agent: Annotated[str | None, Header()] = None):
    return {"User-Agent": user_agent}
```

> **Технические детали**
> 
> `Header` это "братский" класс `Path`, `Query` и `Cookie`. Он также наследуется от того же общего класса `Param`.
> 
> Но помните, что когда вы импортируете `Query`, `Path`, `Header` и другие из `fastapi`, на самом деле это функции,
> которые возвращают специальные классы.

> **Для информации**
> 
> Чтобы объявить заголовки, вам нужно использовать `Header`, потому что иначе параметры будут восприниматься как
> параметры запроса.

<h3>Автоматическое преобразование</h3>

`Header` имеет небольшой дополнительный функционал, в добавок к тому, что предоставляют `Path`, `Query` и `Cookie`.

Большинство стандартных заголовков разделяются символом "дефиса", так же известного как "знак минус" (`-`).

Но переменная вроде `user-agent` в Python недопустима.

Поэтому, по умолчанию, `Header` будет конвертировать символы в названиях параметра, с нижнего подчеркивания (`_`) на (`-`)
чтобы извлекать и документировать заголовки.

Также, HTTP заголовки чувствительны к регистру, поэтому, вы можете объявлять их в стандартном стиле Python 
(также известном как "snake_case").

Отсюда, вы можете использовать `user_agent` как в обычном коде Python, вместо необходимости делать первые буквы заглавными,
как `User_Agent` или что-то вроде.

Если по какой-то причине вам нужно отключить автоматическое преобразование нижних подчеркиваний в дефисы, установите 
параметр `convert_underscores` для`Header` в `False`:

```python
from typing import Annotated

from fastapi import FastAPI, Header

app = FastAPI()

@app.get("/items/")
async def read_items(
        strange_header: Annotated[str | None, Header(convert_underscores=False)] = None
):
    return {"strange_header": strange_header}
```

> **!!! Внимание**
> 
> Перед установкой `convert_underdcores` в значение `False`, имейте в виду, что некоторые HTTP прокси и серверы запрещают
> использование заголовков с нижними подчеркиваниями.

<h3>Дублирование заголовков</h3>

Есть возможность получить дубликат заголовков. Это означает, один заголовок с несколькими значениями.

Вы можете объявлять такие случаи, используя список в объявлении типа.

Вы будете получать все значения из дубликата заголовка как Python `list`.

Например, чтобы объявить заголовок `X-Token` который может появляться больше одного раза, вы можете написать:

```python
from typing import Annotated

from fastapi import FastAPI, Header

app = FastAPI()


@app.get("/items/")
async def read_items(x_token: Annotated[list[str] | None, Header()] = None):
    return {"x_token": x_token}
```

Если вы взаимодействуете с этой операцией пути, отправляя два заголовка HTTP, например:

```python
X-Token: foo
X-Token: bar
```

Ответ может быть таким:

```JSON
{
  "X-Token values": [
    "bar",
    "foo"
  ]
}
```

<h3>Резюме</h3>

Объявляйте заголовки с помощью `Header`, используя тот же общий паттерн как для `Query`, `Path` и `Cookie`.

И не беспокойтесь о нижних подчеркиваниях в ваших переменных, FastAPI позаботится об их конвертации.
